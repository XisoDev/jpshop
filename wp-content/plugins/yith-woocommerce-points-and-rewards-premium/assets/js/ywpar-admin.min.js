jQuery(document).ready(function(t){"use strict";var e=t(document).find("#yit_ywpar_options_extra_points-container").find(".ywpar-section"),n=e.find(".section-head"),a=n.find(".ywpar-remove"),i=n.find(".ywpar-active"),o=e.find(".yith-ywpar-eventype-select"),r="undefined"!=typeof yith_ywpar_admin&&yith_ywpar_admin.block_loader,s="undefined"!=typeof yith_ywpar_admin&&yith_ywpar_admin.del_msg,p=function(e){e.each(function(){var e=t(this),n=e.data("field"),a=e.find("option:selected");c(e,a.val(),n),e.on("change",function(){n=e.data("field"),a=e.find("option:selected"),c(e,a.val(),n)})})},c=function(e,n,a){e.parents(".ywpar-select-wrapper").find("tr.deps-"+a).each(function(){var e=t(this).data("type").split(";");if(-1!==t.inArray(n,e))t(this).show();else if(t(this).hide(),void 0!==t(this).data("rel")){var a="deps-"+t(this).data("rel");t(this).parents(".ywpar-section").find("."+a).hide()}})};t(document).on("click",".ywpar-add-row",function(){var e=t(this),n=e.closest("table"),a=e.closest("tr"),i=parseInt(a.data("index")),o=a.clone(),r=1;n.find("tr").each(function(){var e=t(this).data("index");e>r&&(r=e)});var s=r+1;o.attr("data-index",s),o.find("[name*='extra_points']").each(function(){var e=t(this),n=e.attr("name"),a=e.attr("id"),o=n.replace("[extra_points]["+i+"]","[extra_points]["+s+"]"),r=a.replace("[extra_points]["+i+"]","[extra_points]["+s+"]");e.attr("name",o),e.attr("id",r),e.val("")}),o.find(".remove-row").removeClass("hide-remove"),o.find(".chosen-container").remove(),n.append(o);var c=o.find(".yith-ywpar-eventype-select");o.parents(".ywpar-section");p(c)}),t(document).on("click","#yit_ywpar_options_extra_points-container .remove-row",function(){t(this).closest("tr").remove()}),a.on("click",function(e){e.stopPropagation();var n=t(this),a=n.data("section"),i=n.parents(".ywpar-section");1==window.confirm(s)&&(r&&i.block({message:null,overlayCSS:{background:"#fff url("+r+") no-repeat center",opacity:.5,cursor:"none"}}),t.post(yith_ywpar_admin.ajaxurl,{action:"yith_dynamic_pricing_section_remove",section:a},function(t){i.remove()}))}),i.on("click",function(e){e.stopPropagation();var n=t(this),a=(n.data("section"),n.parents(".section-head").find(".active-hidden-field"));n.hasClass("activated")?(n.removeClass("activated"),a.val("no")):(n.addClass("activated"),a.val("yes"))}),p(o),t(".ywpar_point_earned_dates_fields").each(function(){var e=t(this).find("input").datepicker({defaultDate:"",dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,onSelect:function(n){var a=t(this).data("datepicker"),i=t.datepicker.parseDate(a.settings.dateFormat||t.datepicker._defaults.dateFormat,n,a.settings);e.not(this).datepicker("option","",i)}})}),t(".plugin-option .yit_options .panel-datepicker").each(function(){t(this).datepicker({dateFormat:"yy-mm-dd"})}),t("#yit_ywpar_options_apply_points_previous_order_btn").on("click",function(e){e.preventDefault();var n=t(this).prev().val(),a=t("#yit_ywpar_options_apply_points_previous_order-container .option");a.find(".response").remove(),r&&a.block({message:null,overlayCSS:{background:"transparent",opacity:.5,cursor:"none"}}),t.ajax({type:"POST",url:yith_ywpar_admin.ajaxurl,dataType:"json",data:"action=ywpar_apply_previous_order&from="+n+"&security="+yith_ywpar_admin.apply_previous_order_none,success:function(t){a.unblock(),a.append('<span class="response">'+t+"</span>")}})}),t(".ywrac_reset_points").on("click",function(e){if(e.preventDefault(),!confirm(yith_ywpar_admin.reset_points_confirm))return!1;var n=t("#yit_ywpar_options_reset_points-container .option");n.find(".response").remove(),r&&n.block({message:null,overlayCSS:{background:"transparent",opacity:.5,cursor:"none"}}),t.ajax({type:"POST",url:yith_ywpar_admin.ajaxurl,dataType:"json",data:"action=ywpar_reset_points&security="+yith_ywpar_admin.reset_points,success:function(t){n.unblock(),n.append('<span class="response">'+t+"</span>")}})}),t("#yit_ywpar_options_apply_points_from_wc_points_rewards_btn").on("click",function(e){e.preventDefault();var n=t(this).prev().val(),a=t("#yit_ywpar_options_apply_points_from_wc_points_rewards-container .option");a.find(".response").remove(),r&&a.block({message:null,overlayCSS:{background:"transparent",opacity:.5,cursor:"none"}}),t.ajax({type:"POST",url:yith_ywpar_admin.ajaxurl,dataType:"json",data:"action=ywpar_apply_wc_points_rewards&from="+n+"&security="+yith_ywpar_admin.apply_wc_points_rewards,success:function(t){a.unblock(),a.append('<span class="response">'+t+"</span>")}})}),t("#yit_ywpar_options_fix_expiration_points-container .button").on("click",function(e){e.preventDefault();var n=t("#yit_ywpar_options_fix_expiration_points-container");n.find(".response").remove(),r&&n.block({message:null,overlayCSS:{background:"transparent",opacity:.5,cursor:"none"}}),t.ajax({type:"POST",url:yith_ywpar_admin.ajaxurl,dataType:"json",data:"action=ywpar_fix_expiration_points&security="+yith_ywpar_admin.fix_expiration_points,success:function(t){n.unblock(),n.append('<span class="response">'+t+"</span>"),location.reload(!1)}})});var d=t("#yit_ywpar_options_conversion_rate_method"),_=function(e){"fixed"==e?(t(document).find('input[data-hide="percentage_method"]').closest("tr").hide(),t(document).find(".percentual_method").closest("tr").hide(),t(document).find('input[data-hide="fixed_method"]').closest("tr").show(),t(document).find(".fixed_method").closest("tr").show()):"none"==e?(t(document).find('input[data-hide="percentage_method"]').closest("tr").hide(),t(document).find(".percentual_method").closest("tr").hide(),t(document).find('input[data-hide="fixed_method"]').closest("tr").hide(),t(document).find(".fixed_method").closest("tr").hide()):"percentage"==e&&(t(document).find('input[data-hide="percentage_method"]').closest("tr").show(),t(document).find(".percentual_method").closest("tr").show(),t(document).find('input[data-hide="fixed_method"]').closest("tr").hide(),t(document).find(".fixed_method").closest("tr").hide())};_(d.val()),d.on("change",function(){var e=t(this).val();_(e)}),t("#ywpar_import_points").length&&t("#ywpar_import_points").closest("form").attr("enctype","multipart/form-data"),t("#ywpar_import_points").on("click",function(e){e.preventDefault();var n=t("#type_action").val();t(".ywpar_safe_submit_field").val(n+"_points"),t(this).closest("form").submit()}),t("#type_action").on("change",function(){var e=t(this);"import"==e.val()?e.closest(".option").find("[data-val='import']").show():e.closest(".option").find("[data-val='import']").hide()}),t("#type_action").change(),t("#ywpar-notice-is-dismissable").find(".notice-dismiss").on("click",function(){t.cookie("ywpar_notice","dismiss",{path:"/"})})});